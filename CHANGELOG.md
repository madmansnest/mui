## [Unreleased]

### Added
- Incremental search (incsearch):
  - Search results highlight in real-time as you type
  - Cursor moves to first match while typing
  - Escape cancels search and restores original cursor position
  - Backspace updates search results incrementally
  - Works with both forward (`/`) and backward (`?`) search
  - Word completion popup shows matching words from buffer as you type
  - Tab/Shift+Tab to cycle through completion candidates
  - Completions are extracted from buffer content (identifiers and words)
- Word search commands (`*` and `#`):
  - Normal mode: `*` searches forward for word under cursor
  - Normal mode: `#` searches backward for word under cursor
  - Uses word boundaries (`\b`) for whole-word matching (Vim behavior)
  - Visual mode: `*`/`#` searches for selected text
  - Works in both Visual mode (`v`) and Visual Line mode (`V`)
  - Special regex characters are escaped for literal matching
  - Search state is updated so `n`/`N` continues to find matches
- Visual mode indent commands (Vim-compatible):
  - `>` to add indent to selected lines (shiftwidth spaces or tab)
  - `<` to remove indent from selected lines
  - Works in both Visual mode (`v`) and Visual Line mode (`V`)
  - Empty lines are skipped (Vim behavior)
  - Multiple lines indented as single undo group
  - Cursor moves to first selected line after operation
  - Configuration options: `shiftwidth` (default: 2), `expandtab` (default: true), `tabstop` (default: 8)
  - `reselect_after_indent` option (default: false): Keep selection after indent for continuous adjustment
- Reselect last visual selection (`gv` command):
  - `gv` in Normal mode restores the previous visual selection
  - Works with both Visual mode and Visual Line mode
  - Cursor moves to end of selection
  - Useful for repeating operations on the same selection (e.g., multiple indents)
- Asynchronous job execution system (JobManager):
  - `JobManager` class for managing background tasks with Thread + Queue
  - `Job` class with status tracking (pending, running, completed, failed, cancelled)
  - Thread-safe implementation with Mutex protection
  - `context.run_async { ... }` to run Ruby blocks asynchronously
  - `context.run_shell_command("cmd")` to run external shell commands via Open3
  - `context.jobs_running?` to check if any jobs are active
  - `context.cancel_job(id)` to cancel a running job
  - Callback support via `on_complete:` parameter
  - Autocmd events: JobStarted, JobCompleted, JobFailed, JobCancelled
  - Non-blocking event loop with polling for job results
- Scratch buffer support:
  - `editor.open_scratch_buffer(name, content)` to display read-only results
  - `context.open_scratch_buffer(name, content)` for plugins
  - Opens in horizontal split window
  - Ideal for displaying test results, linter output, etc.
- Readonly buffer protection:
  - `buffer.readonly` flag to mark buffers as read-only
  - Edit commands (`i`, `a`, `o`, `O`, `x`, `d`, `c`, `p`, `P`) blocked with error message
  - `:w` and `:wq` commands blocked on readonly buffers
  - Navigation and yank operations still allowed
- Command-line completion (real-time popup):
  - Auto-completion popup appears as you type in command mode
  - Command name completion for all Ex commands (`:w`, `:q`, `:tabnew`, etc.)
  - File path completion for file commands (`:e`, `:w`, `:sp`, `:vs`, `:tabnew`)
  - Tab to cycle forward through candidates and apply selection
  - Shift+Tab to cycle backward through candidates
  - Popup displays up to 10 candidates with scroll support
  - Completion styles configurable in all 8 themes (`completion_popup`, `completion_popup_selected`)
- Syntax highlighting for Ruby and C:
  - Token-based lexer architecture with extensible base class
  - Ruby lexer with support for: keywords, strings, comments, numbers, symbols, constants, instance variables (`@foo`, `@@bar`), global variables (`$stdout`), method calls (`.to_i`, `.each`)
  - C lexer with support for: keywords, strings, char literals, comments, numbers, preprocessor directives
  - Multiline comment support: Ruby `=begin`/`=end`, C `/* */`
  - Line-based token caching for performance
  - Language auto-detection from file extension
  - Syntax colors defined for all 8 built-in themes
  - Configurable via `set :syntax, true/false` in `.muirc`
- Tab page functionality (Vim-compatible):
  - Tab > Window hierarchy: each tab contains independent window layout
  - `:tabnew` / `:tabe` / `:tabedit` to create new tab
  - `:tabclose` / `:tabc` to close current tab
  - `:tabnext` / `:tabn` to go to next tab
  - `:tabprev` / `:tabp` to go to previous tab
  - `:tabfirst` / `:tabf` to go to first tab
  - `:tablast` / `:tabl` to go to last tab
  - `:Ntabn` / `:tabnext N` to go to specific tab (1-indexed)
  - `:tabmove N` / `:tabm N` to move current tab to position N
  - `gt` to go to next tab (wraps around)
  - `gT` to go to previous tab (wraps around)
  - Tab bar at top of screen with separator line
  - Tab bar colors configurable via color scheme (`tab_bar`, `tab_bar_active`)
  - `:q` closes window → tab → editor (Vim-like behavior)
- Window split functionality:
  - `:sp` / `:split` to split window horizontally (top/bottom)
  - `:vs` / `:vsplit` to split window vertically (left/right)
  - `:sp <filename>` / `:vs <filename>` to split and open file
  - `Ctrl-w h/j/k/l` to navigate between split windows
  - `Ctrl-w w` to cycle to next window
  - `Ctrl-w c` / `:close` to close current window
  - `Ctrl-w o` / `:only` to close all windows except current
  - `:q` / `:wq` / `:q!` in split window closes only that window (Vim-compatible)
  - `:e <filename>` opens file in current window only (doesn't affect other split windows)
  - Separator lines between windows with configurable colors
  - Command line area with configurable background color (no terminal transparency)
  - Each window has independent cursor position, scroll state, and buffer
- Japanese and multibyte character input support:
  - Full UTF-8 input handling in Insert mode via IME
  - Proper display width calculation for CJK characters (East Asian Width)
  - Cursor position correctly accounts for double-width characters
  - UTF-8 byte sequence assembly in terminal adapter
- Plugin system:
  - `Mui.use "gem_name"` to declare plugin gems
  - Lazy gem installation via `bundler/inline` on editor startup
  - Class-based plugins: `class MyPlugin < Mui::Plugin`
  - DSL-based plugins: `Mui.define_plugin(:name) { ... }`
  - Plugin API: `command`, `keymap`, `autocmd`
  - Plugin dependencies with topological sort for load order
  - CommandContext for plugin access to editor internals
- Autocmd event system:
  - 14 events: BufEnter, BufLeave, BufWrite, BufWritePre, BufWritePost, ModeChanged, CursorMoved, TextChanged, InsertEnter, InsertLeave, JobStarted, JobCompleted, JobFailed, JobCancelled
  - Pattern matching for file paths (e.g., `"*.rb"`)
  - `Mui.autocmd :BufEnter, pattern: "*.rb" do |ctx| ... end`
- Custom commands:
  - `Mui.command :name do |ctx| ... end`
  - Execute via `:name` in command mode
- Custom keymaps:
  - `Mui.keymap :normal, "key" do |ctx| ... end`
  - Per-mode key bindings
- Configuration file support:
  - `~/.muirc` for global settings
  - `.lmuirc` for local (per-project) settings
  - Local settings override global settings
  - Ruby DSL format: `Mui.set :colorscheme, "theme_name"`
- Color scheme system:
  - 256-color terminal support
  - Built-in themes: `mui` (default), `solarized_dark`, `solarized_light`, `monokai`, `nord`, `gruvbox_dark`, `dracula`, `tokyo_night`
  - Customizable UI elements: normal text, status line, search highlight, visual selection, line numbers, messages
- Search functionality:
  - `/` to search forward (supports regular expressions)
  - `?` to search backward (supports regular expressions)
  - `n` to jump to next match (respects search direction)
  - `N` to jump to previous match (reverses search direction)
  - Wrap-around search (continues from beginning/end of file)
  - Search match highlighting across visible lines
- Undo/Redo functionality:
  - `u` to undo last change
  - `Ctrl-r` to redo undone change
  - Vim-compatible undo granularity: Insert mode session as single undo unit
  - Support for all editing operations (insert, delete, change, visual mode operations)
  - Maximum 1000 undo history entries
- Vim-compatible named registers:
  - Named registers (`"a` - `"z`): 26 user-specified registers
  - Unnamed register (`""`): Default register
  - Yank register (`"0`): Stores last yank, not affected by delete
  - Delete history registers (`"1` - `"9`): Stores delete history, shifts on each delete
  - Black hole register (`"_`): Discards content without saving
  - Usage: `"ayy` (yank to register a), `"ap` (paste from register a)
- Delete/change operators now save to registers (Vim-compatible behavior):
  - `dd`, `dw`, etc. save deleted text to unnamed register and delete history
  - `cc`, `cw`, etc. save changed text to unnamed register and delete history
  - Visual mode `d`/`c` also save to registers
- Yank operator (`y`):
  - `yy` to yank current line
  - `y` + motion: `yw`, `ye`, `yb`, `y0`, `y$`, `ygg`, `yG`
  - `yf{char}`, `yt{char}`, `yF{char}`, `yT{char}` to yank to/till character
  - `y` in Visual mode to yank selection (character-wise and line-wise)
  - `yw` behaves like `ye` (yanks to end of word) matching Vim behavior
- Paste commands:
  - `p` to paste after cursor (character-wise) or below current line (line-wise)
  - `P` to paste before cursor (character-wise) or above current line (line-wise)
  - Multi-line character-wise paste support
- Register system for yank/paste operations
  - Default register for storing yanked text
  - Named registers support
  - Linewise flag to distinguish line-wise vs character-wise yanks
- TerminalAdapter abstraction layer for custom terminal implementations
  - `Mui::TerminalAdapter::Base` abstract base class defining the terminal interface
  - `Mui::TerminalAdapter::Curses` default implementation using Curses library
  - Users can create custom adapters by subclassing `Base` and passing to `Editor.new(adapter:)`
  - Example: `Mui::Editor.new(file_path, adapter: MyCustomAdapter.new)`
- Initial release of Mui, a Vim-like text editor written in Ruby
- Vim-like modal editing with five modes:
  - Normal mode: Navigation and text manipulation
  - Insert mode: Text input
  - Command mode: Ex commands
  - Visual mode (`v`): Character-wise selection
  - Visual Line mode (`V`): Line-wise selection
- Basic cursor movement with `h`, `j`, `k`, `l` and arrow keys in Normal mode
- Arrow key cursor movement in Insert mode
- Motion commands:
  - Word movements: `w` (word forward), `b` (word backward), `e` (word end)
  - Line movements: `0` (line start), `^` (first non-blank), `$` (line end)
  - File movements: `gg` (file start), `G` (file end)
  - Character search: `f{char}`, `F{char}`, `t{char}`, `T{char}`
- Text editing operations:
  - `i` to insert before cursor
  - `a` to append after cursor
  - `o` to open new line below
  - `O` to open new line above
  - `x` to delete character at cursor
  - Backspace to delete and join lines
- Delete operator (`d`):
  - `dd` to delete current line
  - `d` + motion: `dw`, `de`, `db`, `d0`, `d$`, `dgg`, `dG`
  - `df{char}`, `dt{char}`, `dF{char}`, `dT{char}` to delete to/till character
  - `d` in Visual mode to delete selection (character-wise and line-wise)
- Change operator (`c`):
  - `cc` to change current line (clear and enter Insert mode)
  - `c` + motion: `cw`, `ce`, `cb`, `c0`, `c$`, `cgg`, `cG`
  - `cf{char}`, `ct{char}`, `cF{char}`, `cT{char}` to change to/till character
  - `c` in Visual mode to change selection (character-wise and line-wise)
  - `cw` behaves like `ce` (changes to end of word, preserving space) matching Vim behavior
- Ex commands:
  - `:w` to save file
  - `:w <filename>` to save as
  - `:q` to quit (with unsaved changes protection)
  - `:q!` to force quit
  - `:wq` to save and quit
  - `:e` to reload current file
  - `:e <filename>` to open file (Vim-compatible: non-existent files open as new buffer)
  - `:{number}` to jump to specific line (e.g., `:10` jumps to line 10)
    - Line numbers are 1-indexed (`:1` = first line)
    - Out-of-range values are clamped (`:0` → first line, `:999` on 100-line file → last line)
    - Cursor moves to beginning of line (column 0)
- Curses-based terminal UI with:
  - Buffer management
  - Window with scrolling support
  - Status line display
  - Command line input
- Visual mode features:
  - Selection highlighting with reverse video
  - Toggle between Visual and Visual Line mode with `v`/`V`
  - All motion commands supported (h, j, k, l, w, b, e, 0, ^, $, gg, G, f, F, t, T)
  - Exit to Normal mode with `Esc`
- Comprehensive test suite for `Mui::Input` and `Mui::Editor` classes
  - Unit tests for Buffer, CommandLine, Input, Screen, Window, Selection, and Editor modes
  - Integration tests for component interactions
  - E2E tests with ScriptRunner DSL for Vim operation scenarios including Visual mode
- Test infrastructure with Curses mock and `MuiTestHelper` module

### Changed
- Reorganized test directory structure to follow standard gem conventions
  - Unit tests moved to `test/mui/`
  - Editor mode tests in `test/mui/editor/`
  - Integration tests in `test/integration/`
  - E2E tests in `test/e2e/`
- Refactored test files to use nested classes per method for better readability
- Improved syntax highlighting performance:
  - Use `\G` anchor for position-specific regex matching to avoid substring allocation
  - Pre-compile all regex patterns as class-level constants for one-time compilation at class load
  - Optimize event sorting in line renderer using array tuples instead of hash arrays
  - Add style resolution cache to avoid repeated hash merges
  - Reduce hash lookups in token cache by inlining cache validation

### Fixed
- Auto-indent on newline in Insert mode
  - Pressing Enter preserves indentation from the current line
  - Leading whitespace (spaces and tabs) is automatically inserted on the new line
  - Whitespace-only lines are cleared when pressing Escape (Vim behavior)
- Register is now shared globally across tabs and split windows
  - Yank in one tab/window can be pasted in another
  - Previously each ModeManager had its own Register instance
- Visual mode operations now correctly use the active window's buffer
  - Fixed yank/delete/change/indent operations using stale buffer reference after tab or window switch
  - Operations now properly target the current active window's buffer
- Command mode cursor movement with arrow keys
  - Left/Right arrow keys now move cursor within command line
  - Previously arrow keys were interpreted as characters (e.g., Left inserted 'a')
  - Backspace now deletes character before cursor position
  - Character input now inserts at cursor position
- Empty command (`:` then Enter) no longer crashes
  - Previously caused error when trying to look up empty string as plugin command

## [0.1.0] - 2025-11-30

- Initial release
